{% extends 'base.html' %}
{% block content %}
<h2 class="text-2xl font-bold mb-4">Categorias</h2>
<div class="bg-bg-secondary border border-border-color rounded-lg p-4 mb-4">
  <button onclick="document.getElementById('modal-categoria').showModal()" class="bg-btn-primary text-white border-none rounded-lg px-3 py-2 cursor-pointer">Nova categoria</button>
  <dialog id="modal-categoria" class="border-none rounded-lg p-0">
    <form method="post" action="/categorias/criar" class="p-4 bg-bg-secondary text-text-secondary border border-border-color min-w-80">
      <h3 class="text-lg font-semibold mb-3">Nova Categoria</h3>
      <div class="space-y-3">
        <div>
          <input type="text" name="nome" placeholder="Nome" required class="w-full bg-bg-input text-text-secondary border border-border-color rounded-lg px-2 py-2"/>
        </div>
        <div class="flex gap-2">
          <button type="submit" class="bg-btn-primary text-white border-none rounded-lg px-3 py-2 cursor-pointer">Salvar</button>
          <button type="button" onclick="this.closest('dialog').close()" class="bg-gray-600 text-white border-none rounded-lg px-3 py-2 cursor-pointer">Cancelar</button>
        </div>
      </div>
    </form>
  </dialog>
  <script>
    const mcat = document.getElementById('modal-categoria');
    mcat?.addEventListener('click', (e) => { if (e.target === mcat) mcat.close(); });
  </script>
</div>
<div class="bg-bg-secondary border border-border-color rounded-lg p-4">
  <table class="w-full border-collapse">
    <thead>
      <tr>
        <th class="border-b border-border-color p-2 text-left">Nome</th>
        <th class="border-b border-border-color p-2 text-left">Ações</th>
      </tr>
    </thead>
    <tbody>
      {% for c in categorias %}
        <tr>
          <td class="border-b border-border-color p-2">{{ c.nome }}</td>
          <td class="border-b border-border-color p-2 flex gap-2">
            <button type="button" onclick="document.getElementById('edit-categoria-{{ c.id }}').showModal()" class="bg-btn-primary text-white border-none rounded-lg px-3 py-2 cursor-pointer">Editar</button>
            <form method="post" action="/categorias/excluir/{{ c.id }}" onsubmit="return confirm('Excluir categoria?');" class="inline">
              <button type="submit" class="bg-red-600 text-white border-none rounded-lg px-3 py-2 cursor-pointer">Excluir</button>
            </form>
          </td>
        </tr>
        <dialog id="edit-categoria-{{ c.id }}" class="border-none rounded-lg p-0">
          <form method="post" action="/categorias/editar/{{ c.id }}" class="p-4 bg-bg-secondary text-text-secondary border border-border-color min-w-80">
            <h3 class="text-lg font-semibold mb-3">Editar Categoria</h3>
            <div class="space-y-3">
              <div>
                <input type="text" name="nome" value="{{ c.nome }}" required class="w-full bg-bg-input text-text-secondary border border-border-color rounded-lg px-2 py-2"/>
              </div>
              <div class="flex gap-2">
                <button type="submit" class="bg-btn-primary text-white border-none rounded-lg px-3 py-2 cursor-pointer">Salvar</button>
                <button type="button" onclick="this.closest('dialog').close()" class="bg-gray-600 text-white border-none rounded-lg px-3 py-2 cursor-pointer">Cancelar</button>
              </div>
            </div>
          </form>
        </dialog>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}

